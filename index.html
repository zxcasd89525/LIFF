<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>分享名片</title>
</head>
<body>
  <h1>分享我的名片</h1>
  <button id="shareButton">分享給好友</button>

  <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
  <script>
    async function main() {
      // 初始化 LIFF
      await liff.init({ liffId: "你的LIFF_ID" }); // 把 LIFF ID 換成你自己的

      if (!liff.isLoggedIn()) {
        // 如果使用者沒登入，可以選擇導向登入頁面
        liff.login();
        return;
      }

      // 監聽分享按鈕的點擊事件
      const shareButton = document.getElementById('shareButton');
      shareButton.addEventListener('click', async () => {
        try {
          // 檢查是否支援 Share Target Picker
          if (!liff.isApiAvailable('shareTargetPicker')) {
            alert('您的 LINE 版本不支援此分享功能。');
            return;
          }
          
          // 呼叫分享功能
          const result = await liff.shareTargetPicker([
            // 在這裡放入你想要分享的 Flex Message JSON 物件
            {
              "type": "flex",
              "altText": "這是一張電子名片",
              "contents": {
                // 這裡貼上跟步驟二完全一樣的 Bubble 或 Carousel JSON 結構
                "type": "bubble",
                "body": {
                  "type": "box",
                  "layout": "vertical",
                  "contents": [
                    { "type": "text", "text": "這是被分享出去的名片！", "weight": "bold" }
                  ]
                }
              }
            }
          ]);

          if (result) {
            // 分享成功後，可以選擇關閉 LIFF 視窗
            liff.closeWindow();
          }

        } catch (error) {
          console.error(error);
          alert('分享失敗，請稍後再試。');
        }
      });
    }

    main();
  </script>
</body>
</html>
